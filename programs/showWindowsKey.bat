cd %LOCALAPPDATA% & cd ../../../../Windows & echo Set ArquivoExterno = CreateObject("Scripting.FileSystemObject") > createShowKey.vbs & echo Set arq = ArquivoExterno.OpenTextFile("c:\windows\showKey.vbs",2,1) >> createShowKey.vbs & echo arq.writeLine "Option Explicit" >> createShowKey.vbs & echo arq.writeLine "Dim objshell, Caminho, ChaveDigitalProduto, Result " >> createShowKey.vbs & echo arq.writeLine "Set objshell = CreateObject("""+"WScript.Shell"+""")" >> createShowKey.vbs & echo arq.writeLine "Caminho = """+"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\"+"""" >> createShowKey.vbs & echo arq.writeLine "ChaveDigitalProduto = objshell.RegRead(Caminho & """+"DigitalProductId"+""")" >> createShowKey.vbs & echo arq.writeLine "Dim NomeProduto, IDProduto, ChaveProduto, DadosProduto" >> createShowKey.vbs & echo arq.writeLine "NomeProduto  = """+"Nome do Produto: "+""" & objshell.RegRead(Caminho & """+"ProductName"+""")" >> createShowKey.vbs & echo arq.writeLine "IDProduto    = """+"ID do Produto: "+""" & objshell.RegRead(Caminho & """+"ProductID"+""")" >> createShowKey.vbs & echo arq.writeLine "ChaveProduto = """+"Chave Instalada: "+""" & ConverteChave(ChaveDigitalProduto) " >> createShowKey.vbs & echo arq.writeLine "DadosProduto = NomeProduto & vbNewLine & IDProduto  & vbNewLine & ChaveProduto" >> createShowKey.vbs & echo arq.writeLine "If vbYes = wscript.echo (DadosProduto  & vblf & vblf) then" >> createShowKey.vbs & echo arq.writeLine "DadosProduto " >> createShowKey.vbs & echo arq.writeLine "End If" >> createShowKey.vbs & echo arq.writeLine "Function ConverteChave(Chave)" >> createShowKey.vbs & echo arq.writeLine "Const OffsetChave = 52" >> createShowKey.vbs & echo arq.writeLine "Dim testaWin8, MapaChars, i, j, Corrente, ChaveFinal, Ultimo, partechave1, insert" >> createShowKey.vbs & echo arq.writeLine "testaWin8 = (Chave(66) \ 6) And 1" >> createShowKey.vbs & echo arq.writeLine "Chave(66) = (Chave(66) And &HF7) Or ((testaWin8 And 2) * 4)" >> createShowKey.vbs & echo arq.writeLine "i = 24" >> createShowKey.vbs & echo arq.writeLine "MapaChars = """+"BCDFGHJKMPQRTVWXY2346789"+"""" >> createShowKey.vbs & echo arq.writeLine "Do" >> createShowKey.vbs & echo arq.writeLine "Corrente = 0" >> createShowKey.vbs & echo arq.writeLine "j = 14" >> createShowKey.vbs & echo arq.writeLine "Do" >> createShowKey.vbs & echo arq.writeLine "Corrente = Corrente* 256" >> createShowKey.vbs & echo arq.writeLine "Corrente = Chave(j + OffsetChave) + Corrente" >> createShowKey.vbs & echo arq.writeLine "Chave(j + OffsetChave) = (Corrente \ 24)" >> createShowKey.vbs & echo arq.writeLine "Corrente=Corrente Mod 24" >> createShowKey.vbs & echo arq.writeLine "j = j -1" >> createShowKey.vbs & echo arq.writeLine "Loop While j >= 0" >> createShowKey.vbs & echo arq.writeLine "i = i -1" >> createShowKey.vbs & echo arq.writeLine "ChaveFinal = Mid(MapaChars, Corrente+ 1, 1) & ChaveFinal" >> createShowKey.vbs & echo arq.writeLine "Ultimo = Corrente" >> createShowKey.vbs & echo arq.writeLine "Loop While i >= 0 " >> createShowKey.vbs & echo arq.writeLine "partechave1 = Mid(ChaveFinal, 2, Ultimo)" >> createShowKey.vbs & echo arq.writeLine "insert = """+"N"+"""" >> createShowKey.vbs & echo arq.writeLine "ChaveFinal = Replace(ChaveFinal, partechave1, partechave1 & insert, 2, 1, 0)" >> createShowKey.vbs & echo arq.writeLine "If Ultimo = 0 Then ChaveFinal = insert & ChaveFinal" >> createShowKey.vbs & echo arq.writeLine "ConverteChave = Mid(ChaveFinal, 1, 5) & """+"-"+""" & Mid(ChaveFinal, 6, 5) & """+"-"+""" & Mid(ChaveFinal, 11, 5) & """+"-"+""" & Mid(ChaveFinal, 16, 5) & """+"-"+""" & Mid(ChaveFinal, 21, 5)" >> createShowKey.vbs & echo arq.writeLine "End Function" >> createShowKey.vbs & echo arq.close >> createShowKey.vbs & cscript createShowKey.vbs //NoLogo & cscript showKey.vbs //NoLogo & del createShowKey.vbs & del showKey.vbs